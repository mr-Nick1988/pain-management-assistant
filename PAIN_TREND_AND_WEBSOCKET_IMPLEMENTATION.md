# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –¢—Ä–µ–Ω–¥–∞ –ë–æ–ª–∏ –∏ WebSocket –ê–ª–µ—Ä—Ç—ã

## üìã –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ —Ç—Ä–µ–Ω–¥–∞ –±–æ–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –∏ real-time —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –±–æ–ª–∏ —á–µ—Ä–µ–∑ WebSocket –¥–ª—è –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥–æ–≤.

---

## üéØ –ß—Ç–æ –±—ã–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö** (`src/types/common/types.ts`)

#### PainTrendAnalysisDTO
–ü–æ–ª–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Ç—Ä–µ–Ω–¥–∞ –±–æ–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞:
```typescript
export type PainTrend = 'INCREASING' | 'DECREASING' | 'STABLE' | 'NO_DATA';

export interface PainTrendAnalysisDTO {
    patientMrn: string;
    currentVas: number;           // –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–æ–ª–∏ (0-10)
    previousVas: number;          // –ü—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –±–æ–ª–∏
    vasChange: number;            // –ò–∑–º–µ–Ω–µ–Ω–∏–µ (–º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º)
    lastVasRecordedAt?: string;   // ISO datetime –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–ø–∏—Å–∏
    previousVasRecordedAt?: string; // ISO datetime –ø—Ä–µ–¥—ã–¥—É—â–µ–π –∑–∞–ø–∏—Å–∏
    daysBetweenVasRecords: number; // –î–Ω–µ–π –º–µ–∂–¥—É –∑–∞–ø–∏—Å—è–º–∏
    painTrend: PainTrend;         // –¢—Ä–µ–Ω–¥: INCREASING/DECREASING/STABLE/NO_DATA
    averageVas: number;           // –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –±–æ–ª–∏
    maxVas: number;               // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
    minVas: number;               // –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
    vasHistory: number[];         // –ò—Å—Ç–æ—Ä–∏—è –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
    vasRecordCount: number;       // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
}
```

#### PainEscalationNotificationDTO
WebSocket —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –±–æ–ª–∏:
```typescript
export type EscalationPriority = 'INFO' | 'ALERT' | 'CRITICAL';

export interface PainEscalationNotificationDTO {
    escalationId: number;
    patientMrn: string;
    patientName: string;
    currentVas: number;
    previousVas: number;
    vasChange: number;
    priority: EscalationPriority;  // INFO/ALERT/CRITICAL
    createdAt: string;             // ISO datetime
    latestDiagnoses: string[];     // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–∏–∞–≥–Ω–æ–∑—ã
}
```

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/types/common/types.ts` (—Å—Ç—Ä–æ–∫–∏ 134-175)

---

### 2. **API Slice –¥–ª—è Pain Escalation** (`src/api/api/apiPainEscalationSlice.ts`)

–ù–æ–≤—ã–π RTK Query API slice –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ –±–æ–ª–∏:

```typescript
export const apiPainEscalationSlice = createApi({
    reducerPath: "apiPainEscalation",
    tagTypes: ["PainTrend"],
    baseQuery: fetchBaseQuery({
        baseUrl: base_url,
        credentials: 'include', // –í–∞–∂–Ω–æ: –≤–∫–ª—é—á–∞–µ–º cookies
    }),
    endpoints: (builder) => ({
        getPainTrend: builder.query<PainTrendAnalysisDTO, string>({
            query: (mrn) => `/pain-escalation/patients/${mrn}/trend`,
            providesTags: (_result, _error, mrn) => [{ type: 'PainTrend', id: mrn }],
        }),
    }),
});

export const { useGetPainTrendQuery, useLazyGetPainTrendQuery } = apiPainEscalationSlice;
```

**–≠–Ω–¥–ø–æ–∏–Ω—Ç –±—ç–∫–µ–Ω–¥–∞:** `GET /pain-escalation/patients/{mrn}/trend`

**–•—É–∫–∏:**
- `useGetPainTrendQuery(mrn)` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—Ä–æ—Å –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- `useLazyGetPainTrendQuery()` - —Ä—É—á–Ω–æ–π –∑–∞–ø—Ä–æ—Å –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/api/api/apiPainEscalationSlice.ts`

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Redux Store:** `src/app/store.ts` (—Å—Ç—Ä–æ–∫–∏ 10, 30, 40)

---

### 3. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç PainTrendCard** (`src/components/common/PainTrendCard.tsx`)

–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞ –±–æ–ª–∏ —Å –≥—Ä–∞—Ñ–∏–∫–æ–º.

#### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫ –∏—Å—Ç–æ—Ä–∏–∏ VAS (Recharts LineChart)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Ç–µ–∫—É—â–∏–π/–ø—Ä–µ–¥—ã–¥—É—â–∏–π/–∏–∑–º–µ–Ω–µ–Ω–∏–µ/—Å—Ä–µ–¥–Ω–∏–π/–º–∞–∫—Å/–º–∏–Ω VAS
- ‚úÖ –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ç—Ä–µ–Ω–¥–∞:
  - üìà **INCREASING** (–∫—Ä–∞—Å–Ω—ã–π) - –±–æ–ª—å —É—Å–∏–ª–∏–≤–∞–µ—Ç—Å—è
  - üìâ **DECREASING** (–∑–µ–ª–µ–Ω—ã–π) - –±–æ–ª—å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
  - ‚û°Ô∏è **STABLE** (—Å–∏–Ω–∏–π) - –±–æ–ª—å —Å—Ç–∞–±–∏–ª—å–Ω–∞
  - ‚ÑπÔ∏è **NO_DATA** (—Å–µ—Ä—ã–π) - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π: loading, error, no data
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω (mobile-first)

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```tsx
import { PainTrendCard } from '../common/PainTrendCard';
import { useGetPainTrendQuery } from '../../api/api/apiPainEscalationSlice';

const { data: painTrend, isLoading, error } = useGetPainTrendQuery(mrn, { skip: !mrn });

<PainTrendCard trend={painTrend} isLoading={isLoading} error={error} />
```

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/components/common/PainTrendCard.tsx`

---

### 4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**

#### 4.1 Nurse ‚Üí PatientDetails
**–§–∞–π–ª:** `src/components/nurse/PatientDetails.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–º–ø–æ—Ä—Ç —Ö—É–∫–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 17-18)
- –í—ã–∑–æ–≤ `useGetPainTrendQuery` (—Å—Ç—Ä–æ–∫–∞ 61)
- –†–µ–Ω–¥–µ—Ä `<PainTrendCard />` –ø–æ—Å–ª–µ VAS —Å–µ–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 193)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í–æ–π—Ç–∏ –∫–∞–∫ –º–µ–¥—Å–µ—Å—Ç—Ä–∞
2. –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
3. –£–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É "Pain Trend Analysis" —Å –≥—Ä–∞—Ñ–∏–∫–æ–º

---

#### 4.2 Doctor ‚Üí DoctorPatientDetails
**–§–∞–π–ª:** `src/components/doctor/DoctorPatientDetails.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–º–ø–æ—Ä—Ç —Ö—É–∫–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 22-23)
- –í—ã–∑–æ–≤ `useGetPainTrendQuery` (—Å—Ç—Ä–æ–∫–∞ 51)
- –†–µ–Ω–¥–µ—Ä `<PainTrendCard />` –ø–æ—Å–ª–µ EMR —Å–µ–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 243)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í–æ–π—Ç–∏ –∫–∞–∫ –¥–æ–∫—Ç–æ—Ä
2. –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
3. –£–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É "Pain Trend Analysis" —Å –≥—Ä–∞—Ñ–∏–∫–æ–º

---

#### 4.3 Anesthesiologist ‚Üí AnesthesiologistRecommendationDetails
**–§–∞–π–ª:** `src/components/anesthesiologist/AnesthesiologistRecommendationDetails.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–º–ø–æ—Ä—Ç —Ö—É–∫–∞ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (—Å—Ç—Ä–æ–∫–∏ 25-26)
- **–ö–†–ò–¢–ò–ß–ù–û:** –í—Å–µ —Ö—É–∫–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –î–û early return (—Å—Ç—Ä–æ–∫–∏ 46-51)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ `if (!recommendation || !vas)` (—Å—Ç—Ä–æ–∫–∏ 74-76)
- –í—ã–∑–æ–≤ `useGetPainTrendQuery` (—Å—Ç—Ä–æ–∫–∞ 51)
- –†–µ–Ω–¥–µ—Ä `<PainTrendCard />` –ø–æ—Å–ª–µ EMR —Å–µ–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 255)

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥
2. –û—Ç–∫—Ä—ã—Ç—å —ç—Å–∫–∞–ª–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
3. –£–≤–∏–¥–µ—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É "Pain Trend Analysis" —Å –≥—Ä–∞—Ñ–∏–∫–æ–º

**–í–∞–∂–Ω–æ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏ React Hooks (—Ö—É–∫–∏ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –¥–æ early return) –∏ TypeScript (–¥–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ undefined).

---

### 5. **WebSocket Infrastructure**

#### 5.1 –•—É–∫ useWebSocket (`src/hooks/useWebSocket.ts`)

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ STOMP WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º:

```typescript
export const useWebSocket = () => {
    const [isConnected, setIsConnected] = useState(false);
    const clientRef = useRef<Client | null>(null);

    useEffect(() => {
        const client = new Client({
            webSocketFactory: () => new SockJS(`${base_url}/ws`),
            reconnectDelay: 5000,
            heartbeatIncoming: 4000,
            heartbeatOutgoing: 4000,
            onConnect: () => setIsConnected(true),
            onDisconnect: () => setIsConnected(false),
            onStompError: (frame) => console.error('STOMP error:', frame),
        });

        client.activate();
        return () => client.deactivate();
    }, []);

    return { client, isConnected };
};
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–∫–∞–∂–¥—ã–µ 5 —Å–µ–∫)
- ‚úÖ Heartbeat (4 —Å–µ–∫)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/hooks/useWebSocket.ts`

---

#### 5.2 AnesthesiologistDashboard —Å WebSocket
**–§–∞–π–ª:** `src/components/anesthesiologist/AnesthesiologistDashboard.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò–º–ø–æ—Ä—Ç —Ö—É–∫–∞ –∏ —Ç–∏–ø–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 4-6)
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket (—Å—Ç—Ä–æ–∫–∞ 10-11)
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫ `/topic/escalations/anesthesiologists` (—Å—Ç—Ä–æ–∫–∏ 13-43)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
```typescript
useEffect(() => {
    if (!client || !isConnected) return;

    const subscription = client.subscribe('/topic/escalations/anesthesiologists', (message) => {
        const notification: PainEscalationNotificationDTO = JSON.parse(message.body);

        // –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
        const priorityConfig = {
            CRITICAL: { icon: 'üö®', color: 'red' },
            ALERT: { icon: '‚ö†Ô∏è', color: 'orange' },
            INFO: { icon: '‚ÑπÔ∏è', color: 'blue' },
        };

        const config = priorityConfig[notification.priority];
        
        // –ü–æ–∫–∞–∑–∞—Ç—å toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        toast.warning(
            `${config.icon} Pain Escalation: ${notification.patientName} (MRN: ${notification.patientMrn}) - ` +
            `VAS ${notification.previousVas} ‚Üí ${notification.currentVas} (Œî ${notification.vasChange >= 0 ? '+' : ''}${notification.vasChange})`
        );
    });

    return () => subscription.unsubscribe();
}, [client, isConnected, toast]);
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –í–æ–π—Ç–∏ –∫–∞–∫ –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥
2. –û—Ç–∫—Ä—ã—Ç—å Dashboard
3. –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å: `WebSocket connected`
4. –ü—Ä–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –±–æ–ª–∏ (–±—ç–∫–µ–Ω–¥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ) –ø–æ—è–≤–∏—Ç—Å—è toast:
   - üö® CRITICAL - –∫—Ä–∞—Å–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - ‚ö†Ô∏è ALERT - –æ—Ä–∞–Ω–∂–µ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - ‚ÑπÔ∏è INFO - —Å–∏–Ω–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**
```
üö® Pain Escalation: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω (MRN: MRN001) - VAS 3 ‚Üí 7 (Œî +4)
```

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤ `package.json`:

```json
{
  "dependencies": {
    "recharts": "^2.x.x",           // –ì—Ä–∞—Ñ–∏–∫–∏
    "@stomp/stompjs": "^7.x.x",     // STOMP –∫–ª–∏–µ–Ω—Ç
    "sockjs-client": "^1.x.x"       // SockJS —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
  },
  "devDependencies": {
    "@types/sockjs-client": "^1.x.x" // TypeScript —Ç–∏–ø—ã
  }
}
```

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
npm install
```

### ‚ö†Ô∏è –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "global is not defined"

**–ü—Ä–æ–±–ª–µ–º–∞:** `sockjs-client` —Ç—Ä–µ–±—É–µ—Ç `global` –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω polyfill –≤ `vite.config.ts`:

```typescript
// vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  define: {
    global: 'globalThis',  // ‚Üê –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è sockjs-client
  },
})
```

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è vite.config.ts –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä:**
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
npm run dev
```

---

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±—ç–∫–µ–Ω–¥–∞

### REST API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### GET /pain-escalation/patients/{mrn}/trend
–ü–æ–ª—É—á–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É —Ç—Ä–µ–Ω–¥–∞ –±–æ–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `mrn` (path) - Medical Record Number –ø–∞—Ü–∏–µ–Ω—Ç–∞

**–û—Ç–≤–µ—Ç:** `PainTrendAnalysisDTO`

**–ü—Ä–∏–º–µ—Ä:**
```bash
GET http://localhost:8080/pain-escalation/patients/MRN001/trend
```

---

### WebSocket –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

#### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
```
ws://localhost:8080/ws
```

#### –¢–æ–ø–∏–∫ –¥–ª—è –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥–æ–≤
```
/topic/escalations/anesthesiologists
```

**–§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:** `PainEscalationNotificationDTO` (JSON)

**–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:**
```json
{
  "escalationId": 123,
  "patientMrn": "MRN001",
  "patientName": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤–∏—á",
  "currentVas": 7,
  "previousVas": 3,
  "vasChange": 4,
  "priority": "CRITICAL",
  "createdAt": "2025-11-01T15:30:00Z",
  "latestDiagnoses": ["J18.9", "R52.9"]
}
```

---

## ‚úÖ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Pain Trend Card

#### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```bash
npm run dev
```

#### –®–∞–≥ 2: –í–æ–π—Ç–∏ –∫–∞–∫ –º–µ–¥—Å–µ—Å—Ç—Ä–∞
- Login: `nurse1`
- Password: `password`

#### –®–∞–≥ 3: –û—Ç–∫—Ä—ã—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞
1. –ü–µ—Ä–µ–π—Ç–∏ –≤ "Patients List"
2. –í—ã–±—Ä–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ VAS –∑–∞–ø–∏—Å—è–º–∏
3. –ù–∞–∂–∞—Ç—å "View Details"

#### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É
- –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –∫–∞—Ä—Ç–æ—á–∫–∞ "Pain Trend Analysis"
- –ì—Ä–∞—Ñ–∏–∫ —Å –∏—Å—Ç–æ—Ä–∏–µ–π VAS
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: Current VAS, Previous VAS, Change, Average, Max, Min
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç—Ä–µ–Ω–¥–∞ (üìà/üìâ/‚û°Ô∏è)
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: Total Records, Days Between Last Records

#### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pain Trend Analysis                     ‚îÇ
‚îÇ Status: üìà INCREASING (–∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω)     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Current VAS: 7/10                       ‚îÇ
‚îÇ Previous VAS: 3/10                      ‚îÇ
‚îÇ Change: +4                              ‚îÇ
‚îÇ Average VAS: 5.2                        ‚îÇ
‚îÇ Max VAS: 8                              ‚îÇ
‚îÇ Min VAS: 2                              ‚îÇ
‚îÇ Total Records: 10                       ‚îÇ
‚îÇ Days Between Last Records: 2            ‚îÇ
‚îÇ                                         ‚îÇ
‚îÇ [–ì—Ä–∞—Ñ–∏–∫ –ª–∏–Ω–∏–∏ —Å —Ç–æ—á–∫–∞–º–∏ VAS]            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket –∞–ª–µ—Ä—Ç–æ–≤

#### –®–∞–≥ 1: –í–æ–π—Ç–∏ –∫–∞–∫ –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥
- Login: `anesthesiologist1`
- Password: `password`

#### –®–∞–≥ 2: –û—Ç–∫—Ä—ã—Ç—å Dashboard
- –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª–∏: `WebSocket connected`

#### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
```
WebSocket connected
```

#### –®–∞–≥ 4: –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —ç—Å–∫–∞–ª–∞—Ü–∏—é (–±—ç–∫–µ–Ω–¥)
–ë—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–æ–ø–∏–∫ `/topic/escalations/anesthesiologists`

#### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
–î–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è toast –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É:
```
üö® Pain Escalation: –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω (MRN: MRN001) - VAS 3 ‚Üí 7 (Œî +4)
```

**–¶–≤–µ—Ç–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É:**
- üö® **CRITICAL** - –∫—Ä–∞—Å–Ω—ã–π —Ñ–æ–Ω
- ‚ö†Ô∏è **ALERT** - –æ—Ä–∞–Ω–∂–µ–≤—ã–π —Ñ–æ–Ω
- ‚ÑπÔ∏è **INFO** - —Å–∏–Ω–∏–π —Ñ–æ–Ω

---

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π

#### Loading State
–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pain Trend Analysis                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [Spinner] Loading pain trend data...    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Error State
–ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pain Trend Analysis                     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚ö†Ô∏è Error loading pain trend data        ‚îÇ
‚îÇ Please try again later                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### No Data State
–ö–æ–≥–¥–∞ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö:
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Pain Trend Analysis                     ‚îÇ
‚îÇ Status: ‚ÑπÔ∏è NO_DATA (—Å–µ—Ä—ã–π —Ñ–æ–Ω)          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚ÑπÔ∏è Insufficient data for trend analysis ‚îÇ
‚îÇ At least 2 VAS records are required     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏

### 1. Vite + sockjs-client: "global is not defined"
**–ü—Ä–æ–±–ª–µ–º–∞:** 
```
Uncaught ReferenceError: global is not defined
    at node_modules/sockjs-client/lib/utils/browser-crypto.js
```

**–ü—Ä–∏—á–∏–Ω–∞:** `sockjs-client` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Node.js –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `global`, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω polyfill –≤ `vite.config.ts`:
```typescript
export default defineConfig({
  plugins: [react()],
  define: {
    global: 'globalThis',
  },
})
```

**–§–∞–π–ª:** `vite.config.ts` (—Å—Ç—Ä–æ–∫–∏ 7-9)

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä!

---

### 2. React Hooks Rules
**–ü—Ä–æ–±–ª–µ–º–∞:** –•—É–∫–∏ –≤—ã–∑—ã–≤–∞–ª–∏—Å—å –ø–æ—Å–ª–µ early return –≤ `AnesthesiologistRecommendationDetails`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// ‚ùå –ë–´–õ–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
if (!recWithVas) return <div>...</div>;
const [triggerHistory] = useLazyGetPatientHistoryQuery(); // ‚ùå –ü–æ—Å–ª–µ return!

// ‚úÖ –°–¢–ê–õ–û (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):
const [triggerHistory] = useLazyGetPatientHistoryQuery(); // ‚úÖ –î–æ return!
if (!recWithVas) return <div>...</div>;
```

**–§–∞–π–ª:** `src/components/anesthesiologist/AnesthesiologistRecommendationDetails.tsx` (—Å—Ç—Ä–æ–∫–∏ 46-51)

---

### 2. TypeScript undefined checks
**–ü—Ä–æ–±–ª–µ–º–∞:** 16 –æ—à–∏–±–æ–∫ `'recommendation' is possibly 'undefined'`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –ø–æ—Å–ª–µ early return
if (!recommendation || !vas) {
    return null;
}

// –¢–µ–ø–µ—Ä—å TypeScript –∑–Ω–∞–µ—Ç, —á—Ç–æ recommendation –∏ vas –ù–ï undefined
const drugs = recommendation.drugs; // ‚úÖ –ù–µ—Ç –æ—à–∏–±–∫–∏
```

**–§–∞–π–ª:** `src/components/anesthesiologist/AnesthesiologistRecommendationDetails.tsx` (—Å—Ç—Ä–æ–∫–∏ 74-76)

---

### 3. Unused variables
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ RTK Query

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// ‚ùå –ë–´–õ–û:
providesTags: (result, error, mrn) => [...]

// ‚úÖ –°–¢–ê–õ–û:
providesTags: (_result, _error, mrn) => [...]
```

**–§–∞–π–ª:** `src/api/api/apiPainEscalationSlice.ts` (—Å—Ç—Ä–æ–∫–∞ 22)

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ       ‚îî‚îÄ‚îÄ apiPainEscalationSlice.ts          ‚Üê –ù–æ–≤—ã–π API slice
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ store.ts                               ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω slice)
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ common/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PainTrendCard.tsx                  ‚Üê –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ nurse/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PatientDetails.tsx                 ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω
‚îÇ   ‚îú‚îÄ‚îÄ doctor/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DoctorPatientDetails.tsx           ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω
‚îÇ   ‚îî‚îÄ‚îÄ anesthesiologist/
‚îÇ       ‚îú‚îÄ‚îÄ AnesthesiologistRecommendationDetails.tsx  ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω
‚îÇ       ‚îî‚îÄ‚îÄ AnesthesiologistDashboard.tsx      ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (WebSocket)
‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îî‚îÄ‚îÄ useWebSocket.ts                        ‚Üê –ù–æ–≤—ã–π —Ö—É–∫
‚îî‚îÄ‚îÄ types/
    ‚îî‚îÄ‚îÄ common/
        ‚îî‚îÄ‚îÄ types.ts                           ‚Üê –û–±–Ω–æ–≤–ª–µ–Ω (–Ω–æ–≤—ã–µ —Ç–∏–ø—ã)
```

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
–û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12):
```javascript
// –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
WebSocket connected

// –ï—Å–ª–∏ –Ω–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
STOMP error: ...
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∑–∞–ø—Ä–æ—Å–æ–≤
–û—Ç–∫—Ä—ã—Ç—å Network tab (F12):
```
GET /pain-escalation/patients/MRN001/trend
Status: 200 OK
Response: { patientMrn: "MRN001", currentVas: 7, ... }
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Redux State
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Redux DevTools:
```javascript
// State –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
apiPainEscalation: {
  queries: {
    'getPainTrend("MRN001")': {
      status: 'fulfilled',
      data: { patientMrn: "MRN001", ... }
    }
  }
}
```

---

## üìä –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **React 18** - UI —Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **TypeScript** - —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **RTK Query** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–∞–º–∏
- **Recharts** - –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
- **STOMP.js** - WebSocket –∫–ª–∏–µ–Ω—Ç
- **SockJS** - WebSocket —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
- **Tailwind CSS** - —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è

---

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç RTK Query –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```typescript
// –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å - –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
const { data } = useGetPainTrendQuery("MRN001");

// –í—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å —Å —Ç–µ–º –∂–µ MRN - –∏–∑ –∫—ç—à–∞ (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ)
const { data } = useGetPainTrendQuery("MRN001");

// –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ VAS
dispatch(apiPainEscalationSlice.util.invalidateTags([{ type: 'PainTrend', id: "MRN001" }]));
```

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç WebSocket –ø–æ–¥–ø–∏—Å–∫–∞
```typescript
// 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket
const client = new Client({ webSocketFactory: () => new SockJS('/ws') });
client.activate();

// 2. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–æ–ø–∏–∫
const subscription = client.subscribe('/topic/escalations/anesthesiologists', (message) => {
    const data = JSON.parse(message.body);
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
});

// 3. –û—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
subscription.unsubscribe();
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] `npm install` –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] PainTrendCard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —É –º–µ–¥—Å–µ—Å—Ç—Ä—ã
- [ ] PainTrendCard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —É –¥–æ–∫—Ç–æ—Ä–∞
- [ ] PainTrendCard –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —É –∞–Ω–µ—Å—Ç–µ–∑–∏–æ–ª–æ–≥–∞
- [ ] –ì—Ä–∞—Ñ–∏–∫ Recharts —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –í—Å–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è (–∫–æ–Ω—Å–æ–ª—å: "WebSocket connected")
- [ ] Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ TypeScript
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ ESLint
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ React Hooks

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) - –æ—à–∏–±–∫–∏ JavaScript
2. Network tab - –æ—à–∏–±–∫–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤
3. Redux DevTools - —Å–æ—Å—Ç–æ—è–Ω–∏–µ store
4. –ë—ç–∫–µ–Ω–¥ –ª–æ–≥–∏ - –æ—à–∏–±–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-01  
**–í–µ—Ä—Å–∏—è:** 1.0.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant
